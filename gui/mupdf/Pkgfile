# Depends on: lcms2 harfbuzz libjpeg-turbo openjpeg2 freeglut libx11 libxcursor libxext libxrandr libxinerama freetype


packager="sipo"
contributors=""
maintainer="sipo"


description="Lightweight PDF and XPS viewer"
url="https://mupdf.com/"


name=mupdf
version=1.14.0
release=1


source=(http://www.linuxfromscratch.org/patches/blfs/svn/mupdf-$version-shared_libs-1.patch
	    http://www.mupdf.com/downloads/archive/$name-$version-source.tar.gz)



build() {
unset MAKEFLAGS
cd $name-$version-source

sed -i '/SYS_CURL_LIBS/s|$| -lpthread|' Makethird
rm -rf thirdparty/{curl,freeglut,harfbuzz,libjpeg,openjpeg,zlib}

patch -Np1 -i ../$name-$version-shared_libs-1.patch
export USE_SYSTEM_LIBS=yes
CFLAGS+=' -fPIC' CXXFLAGS+=' -fPIC' make build=release libs apps extra

make prefix=$PKG/usr build=release \
docdir=$PKG/usr/share/doc/$name-$version \
install

ln -svf mupdf-x11-curl $PKG/usr/bin/mupdf
}


